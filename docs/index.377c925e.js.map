{"mappings":"AAEA,MAAMA,EAOFC,YACIC,EACAC,EACAC,EACAC,GAEAC,KAAKJ,SAAWA,EAChBI,KAAKH,SAAWA,EAChBG,KAAKF,IAAMA,EACXE,KAAKD,MAAQA,CACjB,EAGJ,SAASE,EAAiBC,EAAWC,EAAWC,GAE5C,MAAMR,EAAWM,EAAgCG,MAC3CR,EAAWM,EAAgCE,MACjD,IAAIC,EAEJ,GAAIF,EAAU,CACV,MAAMN,EAAMM,EAA+BC,MAC3CC,EAAa,IAAIZ,EAAKE,EAAUC,EAAUC,EAC9C,MAGIQ,EAAa,IAAIZ,EAAKE,EAAUC,GAGpC,OAAOS,CACX,CCnCA,MAAMC,EAAU,6EAEhBC,eAAeC,IAEX,MAAMC,EAAMH,EAAU,aAChBI,QAAiBC,MAAMF,GAE7B,aADoBC,EAASE,MAEjC,CAEAL,eAAeM,EAAWC,GAEtB,IAAIC,GAAkB,EACtB,MAAMC,QAAcR,IAIpB,IAAK,MAAMS,KAAQD,EACf,GAAa,OAATC,GACIA,EAAKtB,WAAamB,EAAQnB,SAAU,CACpCoB,GAAS,EACT,KACJ,CAIR,OAAOA,CACX,CAEAR,eAAeW,EAAUD,GAErB,MAAMtB,SAAEA,EAAQC,SAAEA,GAAaqB,SACTT,KAEdW,SAASF,IAEb,GAAIA,EAAKtB,UAAYA,EACjB,GAAIsB,EAAKrB,UAAYA,EAAU,CAC3B,MAAMwB,EAAaC,KAAKC,UAAUL,GAClCM,eAAeC,QAAQ,aAAcJ,GACrCK,OAAOC,SAASC,OAAO,mBAC3B,MAEIC,MAAM,iB,GAItB,CC/CA,MAAMC,EAAYC,SAASC,eAAe,kBACpCC,EAAYF,SAASC,eAAe,kBACxBD,SAASC,eAAe,cAEhCE,iBAAiB,UAAU1B,MAAO2B,IAGxC,GAFAA,EAAMC,iBAEiBC,MAAnBP,EAAUzB,OAAyC,IAAnByB,EAAUzB,OAAkC,QAAnByB,EAAUzB,OAAsCgC,MAAnBJ,EAAU5B,OAAyC,IAAnB4B,EAAU5B,OAAkC,QAAnB4B,EAAU5B,MAAiB,CAE1K,MAAMa,EAAOjB,EAAiB6B,EAAWG,SACpBnB,EAAWI,GAG5BC,EAAUD,GAGVW,MAAM,qBAEd,MAGIA,MAAM","sources":["src/modules/user.ts","src/modules/database.ts","src/modules/index.ts"],"sourcesContent":["export { User, createUserObject };\n\nclass User {\n\n    public username: string;\n    public password: string;\n    public img?: string;\n    public posts?: object[];\n\n    constructor(\n        username: string,\n        password: string,\n        img?: string,\n        posts?: object[],\n    ) {\n        this.username = username;\n        this.password = password;\n        this.img = img;\n        this.posts = posts;\n    }\n}\n\nfunction createUserObject(nameInput, passInput, picInput?): object {\n\n    const username = (nameInput as HTMLInputElement).value;\n    const password = (passInput as HTMLInputElement).value;\n    let userObject: object;\n\n    if (picInput) {\n        const img = (picInput as HTMLInputElement).value;\n        userObject = new User(username, password, img);\n    }\n\n    else {\n        userObject = new User(username, password);\n    }\n\n    return userObject;\n}","export { fetchDB, userExists, loginUser, addNewUser, loggedInUser, deleteUser, addNewPost };\n\n\nconst baseURL = 'https://megameetings-4101b-default-rtdb.europe-west1.firebasedatabase.app/';\n\nasync function fetchDB(): Promise<any> {\n\n    const url = baseURL + 'users.json';\n    const response = await fetch(url);\n    const users = await response.json();\n    return users;\n}\n\nasync function userExists(newUser): Promise<boolean> {\n\n    let exists: boolean = false;\n    const users = await fetchDB();\n\n\n\n    for (const user of users) {\n        if (user !== null) {\n            if (user.username === newUser.username) {\n                exists = true;\n                break;\n            }\n        }\n    }\n\n    return exists;\n}\n\nasync function loginUser(user): Promise<void> {\n\n    const { username, password } = user;\n    const dbUsers = await fetchDB();\n\n    dbUsers.forEach((user) => {\n\n        if (user.username == username) {\n            if (user.password == password) {\n                const jsonString = JSON.stringify(user);\n                sessionStorage.setItem('activeUser', jsonString);\n                window.location.assign('./html/feed.html');\n            }\n            else {\n                alert('Wrong password');\n            }\n        }\n    })\n}\n\nasync function addNewUser(newUser): Promise<void> {\n\n    const users = await fetchDB();\n    const i = users.length;\n\n    const init = {\n        method: 'PUT',\n        body: JSON.stringify(newUser),\n        headers: {\n            'Content-type': \"application/json; charset=UTF-8\"\n        }\n    }\n\n    const url = `${baseURL}users/${i}.json`;\n    const response = await fetch(url, init);\n    await response.json();\n}\n\nasync function loggedInUser(activeUserObj): Promise<void> {\n\n    const { username, password } = activeUserObj;\n    const dbUsers = await fetchDB();\n    let index;\n\n    dbUsers.forEach((user, i) => {\n        if (user !== null) {\n\n            if (user.username == username) {\n                if (user.password == password) {\n                    index = i;\n                }\n            }\n        }\n    })\n    return index;\n}\n\n\nasync function deleteUser(index): Promise<void> {\n    const init = {\n        method: 'DELETE',\n        // body: JSON.stringify(newUser),\n        headers: {\n            'Content-type': \"application/json; charset=UTF-8\"\n        }\n    }\n\n    const url = `${baseURL}users/${index}.json`;\n    const response = await fetch(url, init);\n    await response.json();\n}\n\n\nasync function addNewPost(newPost, index) {\n\n    console.log(`funkar, nu inne på användare med index ${index} i database`);\n    console.log(`detta vill jag lägga till: ${newPost}`);\n\n    const init = {\n        method: 'POST',\n        body: JSON.stringify(newPost),\n        headers: {\n            'Content-type': \"application/json; charset=UTF-8\"\n        }\n    }\n\n    const url = `${baseURL}users/${index}/posts.json`;\n    const response = await fetch(url, init);\n    await response.json();\n}\n","import { createUserObject } from \"./user\";\nimport { userExists, loginUser } from \"./database\";\n\nconst nameInput = document.getElementById('login-username') as HTMLInputElement;\nconst passInput = document.getElementById('login-password') as HTMLInputElement;\nconst loginForm = document.getElementById(\"login-form\") as HTMLFormElement;\n\nloginForm.addEventListener(\"submit\", async (event) => {\n    event.preventDefault();\n\n    if (nameInput.value != undefined && nameInput.value != '' && nameInput.value != 'none' && passInput.value != undefined && passInput.value != '' && passInput.value != 'none') {\n\n        const user = createUserObject(nameInput, passInput)\n        const exists = await userExists(user);\n\n        if (exists)\n            loginUser(user);\n\n        else\n            alert(`Couldn't find user`);\n\n    }\n\n    else {\n        alert('Name and password is required');\n    }\n})\n"],"names":["$9f26d28743f7b8b7$export$1f44aaf2ec115b54","constructor","username","password","img","posts","this","$9f26d28743f7b8b7$export$a9245fc88c1302ce","nameInput","passInput","picInput","value","userObject","$32c791bd5399aa33$var$baseURL","async","$32c791bd5399aa33$export$3cbc087763719fc4","url","response","fetch","json","$32c791bd5399aa33$export$2cdae35b703e98a","newUser","exists","users","user","$32c791bd5399aa33$export$692b4a7cc7a486ce","forEach","jsonString","JSON","stringify","sessionStorage","setItem","window","location","assign","alert","$f9b32f98613e0134$var$nameInput","document","getElementById","$f9b32f98613e0134$var$passInput","addEventListener","event","preventDefault","undefined"],"version":3,"file":"index.377c925e.js.map"}